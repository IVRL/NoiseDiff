# NoiseDiff

Official PyTorch implementation of our ICCP 2025 paper:  
**[Dark Noise Diffusion: Noise Synthesis for Low-Light Image Denoising](https://arxiv.org/abs/2503.11262v1)**

---

## Get Started

1. **Clone the repository**
    ```bash
    git clone https://github.com/yourusername/NoiseDiff.git
    cd NoiseDiff
    ```

2. **Install dependencies**  
   Run the installation script to set up the required environment.  
   Please install PyTorch and torchvision matching your CUDA device.
    ```bash
    bash install.sh
    ```

3. **Download the SID and ELD datasets**  
   Download the SID dataset from the [Learning-to-See-in-the-Dark repository](https://github.com/cchen156/Learning-to-See-in-the-Dark) and the ELD dataset from the [ELD repository](https://github.com/Vandermode/ELD).  
   Please follow the instructions in each repository for downloading and preparing the datasets.

4. **Download pre-trained models**  
   Download the pre-trained models from [Google Drive](https://drive.google.com/drive/folders/1kIXX-ya_6PQ5UMAzx8YVf2XApq6_53YV?usp=sharing) place them under the root `NoiseDiff` directory.

5. **(Optional) Download our synthetic data**  
   The noise images generated by our model are provided here: [HuggingFace](https://huggingface.co/datasets/SkyeLu/NoiseDiffData).

---

## Usage

All commands for training and testing are provided in `script.sh`. You can modify the paths and parameters in the script as needed.

### 1. Diffusion Network Training & Testing (Data Generation)

- **Training:**  
  Run the training command in `script.sh` to train the diffusion network.
- **Testing / Data Generation:**  
  Use the provided command to generate synthetic noise data. Set the `--resume` argument to the path of your trained model checkpoint, or use the provided pretrained checkpoints in the `--pretrained_ckpts` folder.

- **Logs:** Training logs will be saved in the `./logs` folder.
- **Output:** Generated data will be saved in the `./output` folder.  
  *(Save paths can be changed by changing the `--save_folder` in the commands.)*

### 2. Denoising Training & Testing

- **Training:**  
  Use the corresponding command in `script.sh` to train the denoising network.
- **Testing:**  
  Run the test command to evaluate the denoising performance on the SID or ELD dataset, with or without dark shading correction.  
  Set the `--resume` argument to the path of your trained model checkpoint, or use the provided pretrained checkpoints in the `--pretrained_ckpts` folder.

- **Logs:** Training logs will be saved in the `./logs` folder.
- **Output:** Denoising results will be saved in the `./output` folder.  
  *(Save paths can be changed by changing the `--save_folder` in the commands.)*

---

## Notes

- All commands and usage examples are provided in `script.sh`.  
  Please refer to and modify this script according to your setup and requirements.
- For any issues or questions, please open an issue on this repository, or contact us via email at liying.lu@epfl.ch.

---

## Acknowledgement

This project refers to code from the following repositories, we thank the authors for publishing their code:
- [Learning-to-See-in-the-Dark](https://github.com/cchen156/Learning-to-See-in-the-Dark)
- [PMN](https://github.com/megvii-research/PMN)

---

## Citation

If you find this work useful, please cite our paper:

```
@article{NoiseDiff2025,
  title={Dark Noise Diffusion: Noise Synthesis for Low-Light Image Denoising},
  author={...},
  journal={ICCP},
  year={2025}
}
```
